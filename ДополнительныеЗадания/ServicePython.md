–ö–æ–º–∞–Ω–¥–∞ anestesia.tech –Ω–∞–ø–∏—Å–∞–ª–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ python, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ç—Ä–µ—Ö–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ —Å—Å—ã–ª–∫–µ -> log-analize-python. –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏–º–µ–µ—Ç—Å—è –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞, –≤ —Ç—á –∫–∞–∫ –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è. –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —ç—Ç—É —Å–∏—Å—Ç–µ–º—É –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏:

–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ - Ubuntu 20.04+ / Debian 11+
Python 3.11+
–ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (python virtualenv)
–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–∞–∫–µ—Ç—ã libpq-dev build-essential
–ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞ - /opt/web_monitoring
API-—Å–µ—Ä–≤–µ—Ä (log-server.py) –∏ –¥–∞—à–±–æ—Ä–¥ –∑–∞–ø—É—â–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é systemd
–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
–æ–±—ã—á–Ω—ã–π —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
bash-—Å–∫—Ä–∏–ø—Ç (–≤ —Ç—á –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω–∏–∫) –∫–∞–∫ –æ–±–µ—Ä—Ç–∫–∞
cron –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (—Å—Ç–∞–≤—å—Ç–µ –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ —É–±–∏—Ä–∞—Ç—å –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç—Ä–∞–±–æ—Ç–∫–∏)
systemd —Å–µ—Ä–≤–∏—Å —Ç–∏–ø–∞ oneshot
–ó–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è www-data
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

# –†–µ—à–µ–Ω–∏–µ
–î–µ–ª–∞—é –∫ —Å–µ–±–µ `fork` —Ä–µ–ø–æ–∑–∏—Ç–∞—Ä–∏—è `https://github.com/AnastasiyaGapochkina01/log-analize-python`

### –î–µ–π—Å—Ç–≤–∏—è –Ω–∞ `ssh alrex@192.168.50.34 -p 1234`:
–ü–∞–ø–∫—É web_monitoring
`git init`
'git clone git@github.com:TapAleksej/log-analize-python.git'

–°—Ç–∞–≤–ª—é –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏ –Ω–∞ python –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
`sudo apt install python3.12-venv`

–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –ø–∏—Ç–æ–Ω–∞
```
python3 --version
Python 3.12.3
```


–°–æ–∑–¥–∞—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤
`sudo -u www-data python3 -m venv /opt/web_monitoring/.venv`

–ê–∫—Ç–∏–≤–∏—Ä—É—é –æ–∫—Ä—É–∂–µ–Ω–∏–µ
`source .venv/bin/activate`

–í –Ω–µ–≥–æ –∑–∞–≥—Ä—É–∂–∞—é –ø–∞–∫–µ—Ç—ã –∏–∑ requirements.txt
`sudo -u www-data /opt/web_monitoring/.venv/bin/pip install -U -r requirements.txt`

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤

`sudo chown www-data:www-data /opt/web_monitoring/`
–î–æ–±–∞–≤–∏–ª –Ω–∞ –ø—Ä–∞–≤–∞ –∑–∞–ø–∏—Å—å
`sudo chmod g+w www-data:www-data /opt/web_monitoring/*`

–∏ –Ω–∞ –∑–∞–ø—É—Å–∫ –¥–æ–±–∞–≤–∏–ª –ø—Ä–∞–≤–∞
`sudo chmod x /opt/web_monitoring/*`

*–Ω–æ –¥–æ–ª–∂–µ–Ω –±—ã–ª —Å–æ–∑–¥–∞—Å—Ç—Å—è —Ñ–∞–π–ª info_app.log*
```
ls -ld /opt/web_monitoring
sudo chgrp alrex /opt/web_monitoring
```
–¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É –º–æ–µ–π —É—á–µ—Ç–∫–∏ alrex –ø–æ–ª—É—á–∏–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å.

## –ó–∞–ø—É—Å–∫ log-server
```bash
(.venv) alrex@ubuntu1:/opt/web_monitoring$ python log-server.py
INFO:     Started server process [12708]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:9100 (Press CTRL+C to quit)
INFO:     127.0.0.1:43294 - "GET / HTTP/1.1" 200 OK
```

–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫—É—Ä–ª—ã
```bash
curl http://localhost:9100
```

–°–ª—É—à–∞–µ–º –∂—É—Ä–Ω–∞–ª –∏ –ø–æ–ª—É—á–∞–µ–º –ª–æ–≥–∏ info_app
```bash
alrex@ubuntu1:/opt/web_monitoring$ tail -f info_app.log
2025-06-22 11:22:52 - INFO - GET / from 127.0.0.1 - Status: 200 - 0.007s
2025-06-22 11:24:07 - INFO - GET / from 127.0.0.1 - Status: 200 - 0.0013s
2025-06-22 11:32:46 - INFO - GET / from 192.168.50.34 - Status: 200 - 0.016s
```

## –ó–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
```bash
(.venv) alrex@ubuntu1:/opt/web_monitoring$ python load-generator.py http://localhost:9100 -r 1000 -c 50

==================================================
üõ†Ô∏è Settings:
  Target URL: http://localhost:9100
  Total requests: 1000
  Parallel requests: 50
==================================================


üìä Load testing results:
‚úÖ Successful requests: 0 (0.0%)
‚ùå Failure requests: 1000 (100.0%)
‚è±Ô∏è Total time: 68.03 s
‚ö° Requests per second: 14.70
‚è≥ Average response time: 0.0680 s
```
–ü—Ä–∏ —ç—Ç–æ–º —Å–æ–∑–¥–∞–ª—Å—è —Ñ–∞–π–ª `results.csv` —Å –¥–∞–Ω–Ω—ã–º–∏

## –ó–∞–ø—É—Å–∫ –¥–∞—à–±–æ—Ä–¥–∞

```bash
(.venv) alrex@ubuntu1:/opt/web_monitoring$ python3 dashboard.py
 * Serving Flask app 'dashboard'
 * Debug mode: on
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.50.34:5000
Press CTRL+C to quit
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 402-792-911
```
–ò –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ–ª—É—á–∞–µ–º –ø–æ –∞–¥—Ä–µ—Å—É
`http://192.168.50.34:5000` –¥–∞—à–±–æ–∞—Ä–¥


# Systemd
–°–æ–∑–¥–∞–Ω–∏–µ API-—Å–µ—Ä–≤–µ—Ä–∞ (log-server.py)
`sudo vim /etc/systemd/system/apilog.service`



```bash
[Unit]
Description=API Log Server
After=network.target

[Service]
Type=simple
User=www-data
Group=www-data
WorkingDirectory=/opt/web_monitoring
ExecStart=/opt/web_monitoring/.venv/bin/python3.12 /opt/web_monitoring/log-server.py
Restart=always
StandardOutput=syslog
StandardError=syslog
SyslogIdentifier=apilog
Environment=MYAPP_PORT=9100

[Install]
WantedBy=multi-user.target
```

```
sudo systemctl daemon-reload
sudo systemctl status rsyslog
sudo systemctl start apilog
sudo systemctl status apilog
journalctl -t apilog

sudo systemctl enable apilog
```
–ø—Ä–æ–≤–µ—Ä–∫–∞ `curl http://localhost:9100`

–†–∞–±–æ—Ç–∞–µ—Ç
```
$ tail -f info_app.log
2025-06-22 14:14:07 - INFO - GET / from 127.0.0.1 - Status: 200 - 0.0046s
2025-06-22 14:14:23 - INFO - GET / from 127.0.0.1 - Status: 200 - 0.0008s
```
## –ú–æ–¥–µ–ª–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–° –ø–æ–º–æ—â–±—é —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å—ã

```bash
sudo vi /etc/crontab
```

```bash
5 *   * * * root /opt/web_monitoring/.venv/bin/python3.12 /opt/web_monitoring/load-generator.py http://localhost:9100 -r 1000 -c 50 >> /var/log/load-generator.log 2>&1
```
–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–∞ CRON
```bash
touch /var/log/load-generator.log
# –º–µ–Ω—è–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞ - –Ω—É–∂–Ω–æ –ª–∏?
sudo chown www-data:www-data /var/log/load-generator.log
```

–°–∫—Ä–∏–ø—Ç –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–ª —Ñ–∞–π–ª `results.csv`  - –º–µ–Ω—è–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞
```bash
sudo chown www-data:www-data results.csv
chmod www-data:www-data 750 results.csv
```
–ü—Ä–æ–≤–µ—Ä—è–µ–º - —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
```bash
sudo tail -f /var/log/load-generator.log


üìä Load testing results:
‚úÖ Successful requests: 1000 (100.0%)
‚ùå Failure requests: 0 (0.0%)
‚è±Ô∏è Total time: 147.57 s
‚ö° Requests per second: 6.78
‚è≥ Average response time: 0.1476 s

üïí Total test execution time: 3.16 s
```
## –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è dashboard

```
sudo vim /etc/systemd/system/dashboard.service

[Unit]
Description=Dashboard server
After=network.target

[Service]
Type=oneshot
User=www-data
Group=www-data
WorkingDirectory=/opt/web_monitoring
ExecStart=/opt/web_monitoring/.venv/bin/python3.12 /opt/web_monitoring/dashboard.py
Restart=always
StandardOutput=syslog
StandardError=syslog
SyslogIdentifier=dashboard
Environment=MYAPP_PORT=5000
```
–î–∞–ª–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ
```
sudo systemctl daemon-reload
sudo systemctl restart rsyslog

sudo systemctl start dashboard.service
sudo systemctl status dashboard.service

alrex@ubuntu1:~$ sudo systemctl status dashboard.service
‚óè dashboard.service - Dashboard server
     Loaded: loaded (/etc/systemd/system/dashboard.service; disabled; preset: enabled)
     Active: active (running) since Tue 2025-06-24 10:43:50 UTC; 5s ago
   Main PID: 13489 (python3.12)
      Tasks: 4 (limit: 3735)
     Memory: 111.1M (peak: 111.1M)
        CPU: 5.542s
     CGroup: /system.slice/dashboard.service
             ‚îú‚îÄ13489 /opt/web_monitoring/.venv/bin/python3.12 /opt/web_monitoring/dashboard.py
             ‚îî‚îÄ13491 /opt/web_monitoring/.venv/bin/python3.12 /opt/web_monitoring/dashboard.py

Jun 24 10:43:50 ubuntu1 systemd[1]: Started dashboard.service - Dashboard server.
Jun 24 10:43:53 ubuntu1 dashboard[13489]:  * Serving Flask app 'dashboard'
Jun 24 10:43:53 ubuntu1 dashboard[13489]:  * Debug mode: on
Jun 24 10:43:53 ubuntu1 dashboard[13489]: WARNING: This is a development server. Do not use it in a >
Jun 24 10:43:53 ubuntu1 dashboard[13489]:  * Running on all addresses (0.0.0.0)
Jun 24 10:43:53 ubuntu1 dashboard[13489]:  * Running on http://127.0.0.1:5000
Jun 24 10:43:53 ubuntu1 dashboard[13489]:  * Running on http://192.168.50.34:5000
Jun 24 10:43:53 ubuntu1 dashboard[13489]: Press CTRL+C to quit
Jun 24 10:43:53 ubuntu1 dashboard[13489]:  * Restarting with stat

```
```
sudo systemctl enable dashboard.service
```
–í –±—Ä–∞—É–∑–µ—Ä–µ –∑–∞–ø—É—Å–∫–∞—é  http://127.0.0.1:5000 –∏–ª–∏ http://192.168.50.34:5000

–ø–æ–ª—É—á–∞—é –¥–æ—Å–∫—É

![image](https://github.com/user-attachments/assets/cf3559b5-7b42-4302-98cd-760a0ad4a2a2)

